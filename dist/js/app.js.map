{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","app.js","src/js/app/app.js","src/js/app/background.js","src/js/app/bodyclass.js","src/js/app/utils.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"global","window","$","angular","background","bodyclass","utils","pimpClasses","f5SkinApp","module","factory","stdPreferences","JSON","parse","text","usrPreferences","preferences","extend","f5CoreInfo","update","lastCheck","Date","each","timeSlots","this","from","to","controller","$scope","$modal","param","setImage","topbar","menuItems","topics","siteAlias","toLowerCase","drop","has","breadcrumbs","items","getBreadcrumbs","abo","getSpecialMenu","images","isLoggedIn","userName","isAdmin","userRole","isContributor","sendMail","location","href","rot13","mailIcon","msgClose","customize","open","modalCustomize","templateUrl","resolve","backdrop","keyboard","windowClass","result","then","$modalInstance","ok","close","cancel","dismiss","input","setStaticFolder","site","imgFolder","staticUrl","testLoader","show","delay","hide","positions","repeats","sizes","attachments","isEditMode","isCreateMode","slotCheck","slots","slotEnd","status","getMinute","formatTime","slotStatusOK","slotStatus","edit","index","slot","copy","save","insert","sort","b","findFirst","cbSelectCondition","selectedIndex","sIdx","clone","remove","thisSlot","addMinutes","push","nocheck","splice","create","repeat","position","size","attachment","usePosition","useRepeat","useSize","useAttachment","$filter","$http","dateNextCheck","gap","getTime","updateChecks","check","useFrequency","frequency","checkForUpdate","get","releaseUrl","success","data","$data","version","find","releaseDate","newVersion","parseVersion","error","downloadRelease","alert","self","./background.js","./bodyclass.js","./utils.js",2,"date","getHours","getMinutes","h","attr","load","css","background-image","background-repeat","background-position","background-attachment","background-size","height","fadeOut",3,"pathname","path","replace","trim","split","addClass",4,"linksToObjects","selector","linkObjects","innerText","menuID","c","String","fromCharCode","charCodeAt","minutes","newTime","slice","parseInt"],"mappings":"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","file":"app.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","require('jquery');\r\nvar angular = require('angular'),\r\n    background = require('./background.js'),\r\n    bodyclass = require('./bodyclass.js'),\r\n    utils = require('./utils.js');\r\n\r\n//--- Add additional body classes for individualized CSS rules\r\nbodyclass();\r\n\r\n//--- Pimp old Twoday classes, e.g. button in a .message\r\nutils.pimpClasses();\r\n\r\n//--- Set up the Angular app and controller\r\nvar f5SkinApp = angular.module(\"f5SkinApp\", ['mm.foundation']);\r\n\r\nf5SkinApp.factory(\"Preferences\", function(){\r\n//- Consolidate standardPreferences, userPreferences and generic core info from Twoday macros\r\n    var stdPreferences = JSON.parse($(\"#stdPreferences\").text() || \"{}\"),\r\n        usrPreferences = JSON.parse($(\"#usrPreferences\").text() || \"{}\"),\r\n        preferences = $.extend( {}, stdPreferences, usrPreferences, window.f5CoreInfo);\r\n//- Parse stringified/converted dates and re-convert to true date format\r\n    preferences.update.lastCheck = new Date(Date.parse(preferences.update.lastCheck));\r\n    $.each(preferences.timeSlots, function(){\r\n        this.from = new Date(1970,0,1,(this.from/60>>0),(this.from % 60),0 );\r\n        this.to = new Date(1970,0,1,(this.to/60>>0),(this.to % 60),0 );\r\n    });\r\n//- Provide preferences through dependency injection\r\n    return preferences;\r\n});\r\n\r\nf5SkinApp.controller(\"F5SkinController\", [\"$scope\", \"Preferences\", \"$modal\", function ($scope, preferences, $modal){\r\n\r\n//- Get the consolidated preferences data\r\n    $scope.param = preferences;\r\n\r\n//- Set background image based on hour of the day and user defined image items/slots\r\n    background.setImage($scope.param.timeSlots);\r\n\r\n//- Set default value for topics.text if user has not provided one\r\n    if ($scope.param.topbar.menuItems.topics.text.length===0)\r\n        $scope.param.topbar.menuItems.topics.text = $scope.param.siteAlias.toLowerCase();\r\n\r\n//- Adjust topics.class if topiclist-macro has found/generated any story topics\r\n    $scope.param.topbar.menuItems.topics.drop = ($(\"#toolbarTopics\").has(\".dropdown\"));\r\n\r\n//- Extract breadcrumb/special menu links and put them into the scope\r\n    $scope.param.topbar.menuItems.breadcrumbs.items = utils.getBreadcrumbs();\r\n    //console.dir($scope.param.topbar.menuItems.breadcrumbs.items);\r\n    $scope.param.topbar.menuItems.abo.items = utils.getSpecialMenu(\"#aboMenu\");\r\n    $scope.param.topbar.menuItems.images.items = utils.getSpecialMenu(\"#imageMenu\");\r\n\r\n//- Add utility functions to be used in ng-functions (view)\r\n    $scope.param.isLoggedIn = function(){\r\n        return ($scope.param.userName.length>0);\r\n    };\r\n    $scope.param.isAdmin = function(){\r\n        return ($scope.param.isLoggedIn() && $scope.param.userRole()===\"Administrator\");\r\n    };\r\n    $scope.param.isContributor = function(){\r\n        return ($scope.param.isLoggedIn() && ($scope.param.userRole()===\"Contributor\" || $scope.param.userRole()===\"Administrator\"));\r\n    };\r\n    $scope.param.sendMail = function(){\r\n        window.location.href = utils.rot13($scope.param.topbar.mailIcon.href);\r\n    };\r\n\r\n//- When true (user clicked the close button), it triggers the fadeout of the response alert-box\r\n    $scope.msgClose = false;\r\n\r\n    $scope.customize = {\r\n\r\n        open: function(){\r\n            var modalCustomize = $modal.open({\r\n                templateUrl: \"customizeBlogHtml\",\r\n                controller:  \"CustomizeBlogController\",\r\n                resolve: {\r\n                    param: function (){\r\n                        return $scope.param;\r\n                    }\r\n                },\r\n                backdrop: \"static\",\r\n                keyboard: false,\r\n                windowClass: \"xlarge\"\r\n            });\r\n            modalCustomize.result.then(function(customizedParams){\r\n                //dosomething after OK\r\n            }, function(message){\r\n                //dosomething upon cancel\r\n            });\r\n        }\r\n    };\r\n}]);\r\n\r\nf5SkinApp.controller(\"CustomizeBlogController\", [\"$scope\", \"$modalInstance\", function ($scope, $modalInstance, param){\r\n\r\n    $scope.param = param;\r\n\r\n    $scope.ok = function(){\r\n        $modalInstance.close(\"Pressed OK!\");\r\n    };\r\n\r\n    $scope.cancel = function(){\r\n        $modalInstance.dismiss(\"Pressed Cancel!\");\r\n    };\r\n\r\n}]);\r\n\r\nf5SkinApp.controller(\"tmplGrunddatenController\", [\"$scope\", \"Preferences\", function($scope, preferences){\r\n    $scope.input = preferences;\r\n\r\n    $scope.setStaticFolder = function(){\r\n        $scope.input.site.imgFolder = $scope.input.staticUrl + $scope.input.userName + \"/images/\";\r\n    };\r\n\r\n    $scope.testLoader = function(){\r\n        $(\"#loader-wrapper\").show(0).delay(3000).hide(0);\r\n    };\r\n}]);\r\n\r\nf5SkinApp.controller(\"tmplHintergrundbilderController\", [\"$scope\", \"Preferences\", function($scope, preferences){\r\n    $scope.input = preferences;\r\n\r\n    $scope.positions = [\r\n        \"left top\", \"left center\", \"left bottom\",\r\n        \"right top\", \"right center\", \"right bottom\",\r\n        \"center top\", \"center center\", \"center bottom\"\r\n    ];\r\n\r\n    $scope.repeats = [ \"repeat\", \"repeat-x\", \"repeat-y\", \"no-repeat\" ];\r\n\r\n    $scope.sizes = [ \"auto\", \"cover\", \"contain\" ];\r\n\r\n    $scope.attachments = [ \"fixed\", \"local\", \"scroll\" ];\r\n\r\n    $scope.isEditMode = $scope.isCreateMode = false;\r\n\r\n    $scope.slotCheck = function(){\r\n        var slots=$scope.input.timeSlots, slotEnd=-1, status=(slots.length>0 ? \"\" : \"Keine Hintergrund-Zeitfenster vorhanden!\");\r\n        $.each( $scope.input.timeSlots, function(){\r\n            //console.log(\"from: \"+utils.getMinute(this.from)+\" slotEnd: \"+slotEnd+\" (\"+(slotEnd+1)+\")\");\r\n            if (utils.getMinute(this.from)!==slotEnd+1){\r\n                status = (slotEnd<0\r\n                       ? \"Die Zeitangabe beginnt nicht bei 00:00 Uhr!\"\r\n                       : \"Es besteht eine Zeitlücke bei \"+utils.formatTime(this.from)+\" Uhr!\");\r\n                return false;\r\n            } else slotEnd = utils.getMinute(this.to);\r\n        });\r\n        if (status.length===0 && slotEnd!==23*60+59) status = \"Die Zeitangabe endet nicht bei 23:59 Uhr!\";\r\n        $scope.slotStatusOK = (status.length===0);\r\n        $scope.slotStatus = ($scope.slotStatusOK ? \"Alle Hintergrund-Zeitfenster vollständig definiert.\" : status);\r\n    };\r\n\r\n    $scope.edit = function(index){\r\n        $scope.slot = angular.copy($scope.input.timeSlots[index]);\r\n        $scope.index = index;\r\n        $scope.isEditMode = true;\r\n    };\r\n\r\n    $scope.cancel = function(){\r\n        if ($scope.isCreateMode) delete $scope.slot;\r\n        $scope.isEditMode = $scope.isCreateMode = false;\r\n    };\r\n\r\n    $scope.save = function(){\r\n        if ($scope.isCreateMode) $scope.insert(); else $scope.update();\r\n        $scope.slotCheck();\r\n        $scope.isEditMode = $scope.isCreateMode = false;\r\n    };\r\n\r\n    $scope.sort = function(){\r\n        $scope.input.timeSlots.sort( function(a,b){ return utils.getMinute(a.from) - utils.getMinute(b.from); });\r\n    };\r\n\r\n    $scope.findFirst = function(cbSelectCondition){\r\n        var slots = $scope.input.timeSlots, selectedIndex = -1;\r\n        $.each( slots, function(index, slot){\r\n            if (cbSelectCondition(slot)){\r\n                selectedIndex = index;\r\n                return false;\r\n            }\r\n        });\r\n        return selectedIndex;\r\n    };\r\n\r\n    $scope.insert = function(){\r\n//----- Get the currently defined timeslots\r\n        var slots = $scope.input.timeSlots, slot, sIdx = 0, clone = null;\r\n//----- Delete all old slots that are encompassed/embedded by the new slot\r\n        while (sIdx<slots.length){\r\n            slot = slots[sIdx];\r\n            if (slot.from>=$scope.slot.from && slot.to<=$scope.slot.to)\r\n                $scope.remove(sIdx, false);\r\n            else\r\n                sIdx++;\r\n        }\r\n//----- Find the first slot where new-fromTime is included\r\n        sIdx = $scope.findFirst(function(thisSlot){ return ($scope.slot.from<thisSlot.to); });\r\n        if (sIdx>=0){\r\n            if ($scope.slot.from>slots[sIdx].from && $scope.slot.to<slots[sIdx].to){\r\n                clone = angular.copy(slots[sIdx]);\r\n                clone.from = utils.addMinutes($scope.slot.to, +1);\r\n                slots[sIdx].to = utils.addMinutes($scope.slot.from, -1);\r\n            } else if ($scope.slot.from<=slots[sIdx].from && $scope.slot.to<slots[sIdx].to){\r\n                slots[sIdx].from = utils.addMinutes($scope.slot.to, +1);\r\n            } else if ($scope.slot.to>=slots[sIdx].to){\r\n                slots[sIdx].to = utils.addMinutes($scope.slot.from, -1);\r\n                if (slots.length>sIdx+1) slots[sIdx+1].from = utils.addMinutes($scope.slot.to, +1);\r\n            }\r\n        }\r\n//----- Push the new slot to the array\r\n        slots.push($scope.slot);\r\n//----- Push the clone slot to the array if there is one\r\n        if (clone!==null) slots.push(clone);\r\n//----- and re-sort\r\n        $scope.sort();\r\n    };\r\n\r\n    $scope.update = function(){\r\n        $scope.input.timeSlots[$scope.index] = $scope.slot;\r\n        $scope.sort();\r\n    };\r\n\r\n    $scope.remove = function(index, nocheck){\r\n//----- Get the currently defined timeslots\r\n        var slots = $scope.input.timeSlots;\r\n//----- If index to delete is not the first, then consolidate times with preceeding timeslot\r\n        if (index>0) slots[index-1].to = slots[index].to;\r\n//----- If index is the first and there is a succeeding timeslot, consolidate with succeeding timeslot\r\n        else if (slots.length>1) slots[1].from = slots[0].from;\r\n//----- anyway delete this index now\r\n        slots.splice(index, 1);\r\n//----- and re-check the slots status unless internal call from insert function\r\n        if (nocheck || true) $scope.slotCheck();\r\n    };\r\n\r\n    $scope.create = function(){\r\n        $scope.slot = {\r\n              \"from\": new Date(1970,0,1,0,0,0), \"to\": new Date(1970,0,1,23,59,0),\r\n              \"repeat\": \"no-repeat\", \"position\": \"center top\", \"size\": \"cover\",\r\n              \"attachment\": \"fixed\", \"href\": $scope.input.site.imgFolder };\r\n        $scope.isCreateMode = true;\r\n    };\r\n\r\n    $scope.usePosition = function(index){\r\n        $scope.slot.position = $scope.positions[index];\r\n    };\r\n\r\n    $scope.useRepeat = function(index){\r\n        $scope.slot.repeat = $scope.repeats[index];\r\n    };\r\n\r\n    $scope.useSize = function(index){\r\n        $scope.slot.size = $scope.sizes[index];\r\n    };\r\n\r\n    $scope.useAttachment = function(index){\r\n        $scope.slot.attachment = $scope.attachments[index];\r\n    };\r\n\r\n    $scope.slotCheck();\r\n\r\n}]);\r\n\r\nf5SkinApp.controller(\"tmplAktualisierung\", [\"$scope\", \"$filter\", \"$http\", \"Preferences\", function($scope, $filter, $http, preferences){\r\n    $scope.input = preferences;\r\n\r\n    $scope.msgClose = true;\r\n\r\n    $scope.dateNextCheck = function(){\r\n        return ($scope.input.update.gap<0\r\n            ? \"Keine Prüfung\"\r\n            : $filter('date')(new Date($scope.input.update.lastCheck.getTime()+$scope.input.update.gap), \"dd.MM.yyyy hh:mm\"));\r\n    };\r\n\r\n    $scope.updateChecks = [\r\n        { check: \"täglich\", gap: 24*60*60*1000 },\r\n        { check: \"wöchentlich\", gap: 7*24*60*60*1000 },\r\n        { check: \"monatlich\", gap: 30*24*60*60*1000 },\r\n        { check: \"niemals\", gap: -1 }\r\n    ];\r\n\r\n    $scope.useFrequency = function(index){\r\n        var frequency = $scope.updateChecks[index];\r\n        $scope.input.update.check = frequency.check;\r\n        $scope.input.update.gap = frequency.gap;\r\n    };\r\n\r\n    $scope.checkForUpdate = function(){\r\n        $http.get($scope.input.update.releaseUrl+\"releaseinfo.xml\")\r\n          .success(function(data, status, headers, config){\r\n                var $data = $(data);\r\n                $scope.version = $data.find(\"version\").text();\r\n                $scope.releaseDate = new Date(Date.parse($data.find(\"releasedate\").text()));\r\n                $scope.newVersion = (utils.parseVersion($scope.version)>utils.parseVersion($scope.input.update.version));\r\n                $scope.msgClose = false;\r\n          })\r\n          .error(function(data, status, headers, config){\r\n          });\r\n    };\r\n\r\n    $scope.downloadRelease = function(){\r\n        alert(\"Download started!\");\r\n    }\r\n}]);","(typeof window !== \"undefined\" ? window.$ : typeof global !== \"undefined\" ? global.$ : null);\r\nvar angular = (typeof window !== \"undefined\" ? window.angular : typeof global !== \"undefined\" ? global.angular : null),\r\n    background = require('./background.js'),\r\n    bodyclass = require('./bodyclass.js'),\r\n    utils = require('./utils.js');\r\n\r\n//--- Add additional body classes for individualized CSS rules\r\nbodyclass();\r\n\r\n//--- Pimp old Twoday classes, e.g. button in a .message\r\nutils.pimpClasses();\r\n\r\n//--- Set up the Angular app and controller\r\nvar f5SkinApp = angular.module(\"f5SkinApp\", ['mm.foundation']);\r\n\r\nf5SkinApp.factory(\"Preferences\", function(){\r\n//- Consolidate standardPreferences, userPreferences and generic core info from Twoday macros\r\n    var stdPreferences = JSON.parse($(\"#stdPreferences\").text() || \"{}\"),\r\n        usrPreferences = JSON.parse($(\"#usrPreferences\").text() || \"{}\"),\r\n        preferences = $.extend( {}, stdPreferences, usrPreferences, window.f5CoreInfo);\r\n//- Parse stringified/converted dates and re-convert to true date format\r\n    preferences.update.lastCheck = new Date(Date.parse(preferences.update.lastCheck));\r\n    $.each(preferences.timeSlots, function(){\r\n        this.from = new Date(1970,0,1,(this.from/60>>0),(this.from % 60),0 );\r\n        this.to = new Date(1970,0,1,(this.to/60>>0),(this.to % 60),0 );\r\n    });\r\n//- Provide preferences through dependency injection\r\n    return preferences;\r\n});\r\n\r\nf5SkinApp.controller(\"F5SkinController\", [\"$scope\", \"Preferences\", \"$modal\", function ($scope, preferences, $modal){\r\n\r\n//- Get the consolidated preferences data\r\n    $scope.param = preferences;\r\n\r\n//- Set background image based on hour of the day and user defined image items/slots\r\n    background.setImage($scope.param.timeSlots);\r\n\r\n//- Set default value for topics.text if user has not provided one\r\n    if ($scope.param.topbar.menuItems.topics.text.length===0)\r\n        $scope.param.topbar.menuItems.topics.text = $scope.param.siteAlias.toLowerCase();\r\n\r\n//- Adjust topics.class if topiclist-macro has found/generated any story topics\r\n    $scope.param.topbar.menuItems.topics.drop = ($(\"#toolbarTopics\").has(\".dropdown\"));\r\n\r\n//- Extract breadcrumb/special menu links and put them into the scope\r\n    $scope.param.topbar.menuItems.breadcrumbs.items = utils.getBreadcrumbs();\r\n    //console.dir($scope.param.topbar.menuItems.breadcrumbs.items);\r\n    $scope.param.topbar.menuItems.abo.items = utils.getSpecialMenu(\"#aboMenu\");\r\n    $scope.param.topbar.menuItems.images.items = utils.getSpecialMenu(\"#imageMenu\");\r\n\r\n//- Add utility functions to be used in ng-functions (view)\r\n    $scope.param.isLoggedIn = function(){\r\n        return ($scope.param.userName.length>0);\r\n    };\r\n    $scope.param.isAdmin = function(){\r\n        return ($scope.param.isLoggedIn() && $scope.param.userRole()===\"Administrator\");\r\n    };\r\n    $scope.param.isContributor = function(){\r\n        return ($scope.param.isLoggedIn() && ($scope.param.userRole()===\"Contributor\" || $scope.param.userRole()===\"Administrator\"));\r\n    };\r\n    $scope.param.sendMail = function(){\r\n        window.location.href = utils.rot13($scope.param.topbar.mailIcon.href);\r\n    };\r\n\r\n//- When true (user clicked the close button), it triggers the fadeout of the response alert-box\r\n    $scope.msgClose = false;\r\n\r\n    $scope.customize = {\r\n\r\n        open: function(){\r\n            var modalCustomize = $modal.open({\r\n                templateUrl: \"customizeBlogHtml\",\r\n                controller:  \"CustomizeBlogController\",\r\n                resolve: {\r\n                    param: function (){\r\n                        return $scope.param;\r\n                    }\r\n                },\r\n                backdrop: \"static\",\r\n                keyboard: false,\r\n                windowClass: \"xlarge\"\r\n            });\r\n            modalCustomize.result.then(function(customizedParams){\r\n                //dosomething after OK\r\n            }, function(message){\r\n                //dosomething upon cancel\r\n            });\r\n        }\r\n    };\r\n}]);\r\n\r\nf5SkinApp.controller(\"CustomizeBlogController\", [\"$scope\", \"$modalInstance\", function ($scope, $modalInstance, param){\r\n\r\n    $scope.param = param;\r\n\r\n    $scope.ok = function(){\r\n        $modalInstance.close(\"Pressed OK!\");\r\n    };\r\n\r\n    $scope.cancel = function(){\r\n        $modalInstance.dismiss(\"Pressed Cancel!\");\r\n    };\r\n\r\n}]);\r\n\r\nf5SkinApp.controller(\"tmplGrunddatenController\", [\"$scope\", \"Preferences\", function($scope, preferences){\r\n    $scope.input = preferences;\r\n\r\n    $scope.setStaticFolder = function(){\r\n        $scope.input.site.imgFolder = $scope.input.staticUrl + $scope.input.userName + \"/images/\";\r\n    };\r\n\r\n    $scope.testLoader = function(){\r\n        $(\"#loader-wrapper\").show(0).delay(3000).hide(0);\r\n    };\r\n}]);\r\n\r\nf5SkinApp.controller(\"tmplHintergrundbilderController\", [\"$scope\", \"Preferences\", function($scope, preferences){\r\n    $scope.input = preferences;\r\n\r\n    $scope.positions = [\r\n        \"left top\", \"left center\", \"left bottom\",\r\n        \"right top\", \"right center\", \"right bottom\",\r\n        \"center top\", \"center center\", \"center bottom\"\r\n    ];\r\n\r\n    $scope.repeats = [ \"repeat\", \"repeat-x\", \"repeat-y\", \"no-repeat\" ];\r\n\r\n    $scope.sizes = [ \"auto\", \"cover\", \"contain\" ];\r\n\r\n    $scope.attachments = [ \"fixed\", \"local\", \"scroll\" ];\r\n\r\n    $scope.isEditMode = $scope.isCreateMode = false;\r\n\r\n    $scope.slotCheck = function(){\r\n        var slots=$scope.input.timeSlots, slotEnd=-1, status=(slots.length>0 ? \"\" : \"Keine Hintergrund-Zeitfenster vorhanden!\");\r\n        $.each( $scope.input.timeSlots, function(){\r\n            //console.log(\"from: \"+utils.getMinute(this.from)+\" slotEnd: \"+slotEnd+\" (\"+(slotEnd+1)+\")\");\r\n            if (utils.getMinute(this.from)!==slotEnd+1){\r\n                status = (slotEnd<0\r\n                       ? \"Die Zeitangabe beginnt nicht bei 00:00 Uhr!\"\r\n                       : \"Es besteht eine Zeitlücke bei \"+utils.formatTime(this.from)+\" Uhr!\");\r\n                return false;\r\n            } else slotEnd = utils.getMinute(this.to);\r\n        });\r\n        if (status.length===0 && slotEnd!==23*60+59) status = \"Die Zeitangabe endet nicht bei 23:59 Uhr!\";\r\n        $scope.slotStatusOK = (status.length===0);\r\n        $scope.slotStatus = ($scope.slotStatusOK ? \"Alle Hintergrund-Zeitfenster vollständig definiert.\" : status);\r\n    };\r\n\r\n    $scope.edit = function(index){\r\n        $scope.slot = angular.copy($scope.input.timeSlots[index]);\r\n        $scope.index = index;\r\n        $scope.isEditMode = true;\r\n    };\r\n\r\n    $scope.cancel = function(){\r\n        if ($scope.isCreateMode) delete $scope.slot;\r\n        $scope.isEditMode = $scope.isCreateMode = false;\r\n    };\r\n\r\n    $scope.save = function(){\r\n        if ($scope.isCreateMode) $scope.insert(); else $scope.update();\r\n        $scope.slotCheck();\r\n        $scope.isEditMode = $scope.isCreateMode = false;\r\n    };\r\n\r\n    $scope.sort = function(){\r\n        $scope.input.timeSlots.sort( function(a,b){ return utils.getMinute(a.from) - utils.getMinute(b.from); });\r\n    };\r\n\r\n    $scope.findFirst = function(cbSelectCondition){\r\n        var slots = $scope.input.timeSlots, selectedIndex = -1;\r\n        $.each( slots, function(index, slot){\r\n            if (cbSelectCondition(slot)){\r\n                selectedIndex = index;\r\n                return false;\r\n            }\r\n        });\r\n        return selectedIndex;\r\n    };\r\n\r\n    $scope.insert = function(){\r\n//----- Get the currently defined timeslots\r\n        var slots = $scope.input.timeSlots, slot, sIdx = 0, clone = null;\r\n//----- Delete all old slots that are encompassed/embedded by the new slot\r\n        while (sIdx<slots.length){\r\n            slot = slots[sIdx];\r\n            if (slot.from>=$scope.slot.from && slot.to<=$scope.slot.to)\r\n                $scope.remove(sIdx, false);\r\n            else\r\n                sIdx++;\r\n        }\r\n//----- Find the first slot where new-fromTime is included\r\n        sIdx = $scope.findFirst(function(thisSlot){ return ($scope.slot.from<thisSlot.to); });\r\n        if (sIdx>=0){\r\n            if ($scope.slot.from>slots[sIdx].from && $scope.slot.to<slots[sIdx].to){\r\n                clone = angular.copy(slots[sIdx]);\r\n                clone.from = utils.addMinutes($scope.slot.to, +1);\r\n                slots[sIdx].to = utils.addMinutes($scope.slot.from, -1);\r\n            } else if ($scope.slot.from<=slots[sIdx].from && $scope.slot.to<slots[sIdx].to){\r\n                slots[sIdx].from = utils.addMinutes($scope.slot.to, +1);\r\n            } else if ($scope.slot.to>=slots[sIdx].to){\r\n                slots[sIdx].to = utils.addMinutes($scope.slot.from, -1);\r\n                if (slots.length>sIdx+1) slots[sIdx+1].from = utils.addMinutes($scope.slot.to, +1);\r\n            }\r\n        }\r\n//----- Push the new slot to the array\r\n        slots.push($scope.slot);\r\n//----- Push the clone slot to the array if there is one\r\n        if (clone!==null) slots.push(clone);\r\n//----- and re-sort\r\n        $scope.sort();\r\n    };\r\n\r\n    $scope.update = function(){\r\n        $scope.input.timeSlots[$scope.index] = $scope.slot;\r\n        $scope.sort();\r\n    };\r\n\r\n    $scope.remove = function(index, nocheck){\r\n//----- Get the currently defined timeslots\r\n        var slots = $scope.input.timeSlots;\r\n//----- If index to delete is not the first, then consolidate times with preceeding timeslot\r\n        if (index>0) slots[index-1].to = slots[index].to;\r\n//----- If index is the first and there is a succeeding timeslot, consolidate with succeeding timeslot\r\n        else if (slots.length>1) slots[1].from = slots[0].from;\r\n//----- anyway delete this index now\r\n        slots.splice(index, 1);\r\n//----- and re-check the slots status unless internal call from insert function\r\n        if (nocheck || true) $scope.slotCheck();\r\n    };\r\n\r\n    $scope.create = function(){\r\n        $scope.slot = {\r\n              \"from\": new Date(1970,0,1,0,0,0), \"to\": new Date(1970,0,1,23,59,0),\r\n              \"repeat\": \"no-repeat\", \"position\": \"center top\", \"size\": \"cover\",\r\n              \"attachment\": \"fixed\", \"href\": $scope.input.site.imgFolder };\r\n        $scope.isCreateMode = true;\r\n    };\r\n\r\n    $scope.usePosition = function(index){\r\n        $scope.slot.position = $scope.positions[index];\r\n    };\r\n\r\n    $scope.useRepeat = function(index){\r\n        $scope.slot.repeat = $scope.repeats[index];\r\n    };\r\n\r\n    $scope.useSize = function(index){\r\n        $scope.slot.size = $scope.sizes[index];\r\n    };\r\n\r\n    $scope.useAttachment = function(index){\r\n        $scope.slot.attachment = $scope.attachments[index];\r\n    };\r\n\r\n    $scope.slotCheck();\r\n\r\n}]);\r\n\r\nf5SkinApp.controller(\"tmplAktualisierung\", [\"$scope\", \"$filter\", \"$http\", \"Preferences\", function($scope, $filter, $http, preferences){\r\n    $scope.input = preferences;\r\n\r\n    $scope.msgClose = true;\r\n\r\n    $scope.dateNextCheck = function(){\r\n        return ($scope.input.update.gap<0\r\n            ? \"Keine Prüfung\"\r\n            : $filter('date')(new Date($scope.input.update.lastCheck.getTime()+$scope.input.update.gap), \"dd.MM.yyyy hh:mm\"));\r\n    };\r\n\r\n    $scope.updateChecks = [\r\n        { check: \"täglich\", gap: 24*60*60*1000 },\r\n        { check: \"wöchentlich\", gap: 7*24*60*60*1000 },\r\n        { check: \"monatlich\", gap: 30*24*60*60*1000 },\r\n        { check: \"niemals\", gap: -1 }\r\n    ];\r\n\r\n    $scope.useFrequency = function(index){\r\n        var frequency = $scope.updateChecks[index];\r\n        $scope.input.update.check = frequency.check;\r\n        $scope.input.update.gap = frequency.gap;\r\n    };\r\n\r\n    $scope.checkForUpdate = function(){\r\n        $http.get($scope.input.update.releaseUrl+\"releaseinfo.xml\")\r\n          .success(function(data, status, headers, config){\r\n                var $data = $(data);\r\n                $scope.version = $data.find(\"version\").text();\r\n                $scope.releaseDate = new Date(Date.parse($data.find(\"releasedate\").text()));\r\n                $scope.newVersion = (utils.parseVersion($scope.version)>utils.parseVersion($scope.input.update.version));\r\n                $scope.msgClose = false;\r\n          })\r\n          .error(function(data, status, headers, config){\r\n          });\r\n    };\r\n\r\n    $scope.downloadRelease = function(){\r\n        alert(\"Download started!\");\r\n    }\r\n}]);","(typeof window !== \"undefined\" ? window.$ : typeof global !== \"undefined\" ? global.$ : null);\r\n/**\r\n * Sets the appropriate background image based on the actual hour of the day and user defined image items/slots\r\n */\r\nmodule.exports = {\r\n    setImage: function(timeSlots){\r\n        var getMinute = function(date){ return date.getHours()*60+date.getMinutes(); };\r\n//----- return immediately if there are no user defined time slots/images\r\n        if (timeSlots.length===0) return;\r\n//----- get the current minute of the day\r\n        var h = getMinute(new Date());\r\n//----- check with each timeslot to find the appropriate entry\r\n        $.each( timeSlots, function(){\r\n            if (h>=getMinute(this.from) && h<=getMinute(this.to)){\r\n//------------- once timeslot was found, preload the image\r\n                var self = this;\r\n                $('<img/>').attr('src', self.href).load( function(){\r\n//----------------- remove the temp img to prevent memory leaks\r\n                    $(this).remove();\r\n//----------------- now set the background-image with all params\r\n                    $('body').css({\r\n                        'background-image': 'url(\"'+self.href+'\")',\r\n                        'background-repeat': self.repeat,\r\n                        'background-position': self.position,\r\n                        'background-attachment': self.attachment,\r\n                        'background-size': self.size,\r\n                        'height': '100%'\r\n                    });\r\n//----------------- and fade the preloading animation\r\n                    $(\"#loader-wrapper\").fadeOut(\"slow\");\r\n                });\r\n//------------- then quit the each loop\r\n                return false;\r\n            }\r\n        });\r\n    }\r\n};","(typeof window !== \"undefined\" ? window.$ : typeof global !== \"undefined\" ? global.$ : null);\r\n/**\r\n * Adds additional classes to the BODY element\r\n * onHome ~ if the homepage is displayed\r\n * onTopic ~ if a topic page is displayed\r\n * topic-{topicID} ~ ID of the topic (lowercase ID)\r\n * onStory ~ if a story is displayed\r\n * story-{storyID} ~ ID of the story (lowercase ID)\r\n *\r\n * Examples:\r\n * pathname=\"/\" ===> bodyclasses=\"onHome\"\r\n * pathname=\"/topics/Testthema/\" ==> bodyclasses=\"onTopic topic-testthema\"\r\n * pathname=\"/stories/is-it-me-youre-looking-for/\" ==> bodyclasses=\"onStory story-is-it-me-youre-looking-for\"\r\n *\r\n */\r\nmodule.exports = function(){\r\n    var bodyclass = \"\";\r\n    if (location.pathname===\"/\") bodyclass = \"onHome\";\r\n    else {\r\n        var path = location.pathname.replace(/\\//g, \" \").trim().split(\" \");\r\n        switch (path[0]) {\r\n            case \"topics\":  bodyclass = \"onTopic \" + path[1].toLowerCase(); break;\r\n            case \"stories\": bodyclass = \"onStory \" + path[1].toLowerCase(); break;\r\n        }\r\n    }\r\n    if (bodyclass.length>0) $(\"body\").addClass(bodyclass);\r\n};","(typeof window !== \"undefined\" ? window.$ : typeof global !== \"undefined\" ? global.$ : null);\r\nmodule.exports = {\r\n\r\n//- Converts selected DOM links to an array of link objects (href,text)\r\n    linksToObjects: function(selector){\r\n        var linkObjects = [];\r\n            $(selector).each( function(){\r\n                linkObjects.push({ \"href\": this.href, \"text\": this.innerText });\r\n            });\r\n        return linkObjects;\r\n    },\r\n\r\n//- Extract breadcrumbs-links out of Twoday's modToolbarNavigationpath-macro and return as an array of link objects\r\n    getBreadcrumbs: function(){\r\n        return this.linksToObjects(\"#breadcrumbsMenu >a:not([id])\");\r\n    },\r\n\r\n//- Get special menu items (imageMenu/aboMenu) as an array of link objects\r\n    getSpecialMenu: function(menuID){\r\n        return this.linksToObjects(menuID+\" a\");\r\n    },\r\n\r\n//- Pimp server generated Twoday classes to enforce Foundation style\r\n    pimpClasses: function(){\r\n        $(\".message .button\").addClass(\"secondary tiny radius\");\r\n    },\r\n\r\n//- Rotation13 method used to obfuscate email-address\r\n    rot13: function(s){\r\n        return s.replace(/[a-zA-Z]/g, function(c){\r\n            return String.fromCharCode((c <= \"Z\" ? 90 : 122) >= (c = c.charCodeAt(0) + 13) ? c : c - 26);\r\n        });\r\n    },\r\n\r\n//- Gets minutes from a given date\r\n    getMinute: function(date){\r\n        return date.getHours()*60+date.getMinutes();\r\n    },\r\n\r\n//- Adds/Subtracts minutes from a given date (add: minutes>0, subtract: minutes<0)\r\n    addMinutes: function(date, minutes){\r\n        var newTime = this.getMinute(date) + minutes;\r\n        return new Date(1970,0,1,(newTime/60>>0),(newTime % 60),0);\r\n    },\r\n\r\n//- Formats time string to \"hh:mm\"\r\n    formatTime: function(date){\r\n        return (\"0\"+date.getHours()).slice(-2)+\":\"+(\"0\"+date.getMinutes()).slice(-2);\r\n    },\r\n\r\n//- Converts string-version (\"1.2.3\") to a comparable int (123)\r\n    parseVersion: function(version){\r\n        return parseInt(version.replace(/\\./g,\"\"));\r\n    }\r\n\r\n};"],"sourceRoot":"/source/"}